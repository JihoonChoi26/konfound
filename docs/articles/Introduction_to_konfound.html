<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to konfound • konfound</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">konfound</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Introduction to konfound</h1>
                        <h4 class="author">Joshua Rosenberg, Ran Xu, and Ken Frank</h4>
            
            <h4 class="date">2017-11-05</h4>
          </div>

    
    
<div class="contents">
<div id="abstract" class="section level1">
<h1 class="hasAnchor">
<a href="#abstract" class="anchor"></a>Abstract</h1>
<p><em>This abstract is adapted from Xu, Frank, and Maroulis’ STATA tutorial “What would it take to Change your Inference? Quantifying the Discourse about Causal Inferences in the Social Sciences”</em></p>
<p>Statistical methods that quantify the discourse about causal inferences in terms of possible sources of biases, or “sensitivity analysis,” is becoming more important to a variety of social science fields, including research in education, public policy, and political science. A series of recent works by Frank and colleagues on sensitivity analysis points to limitations in earlier methods and aims to extend beyond them. We implement these developments, which previously have been implemented in <code>Stata</code>, in <code>R</code> through the <code>konfound</code> package. In particular, we provide functions for quantifying the bias necessary to alter an inference, from the framework of Rubin’s (1974) causal model, as well as the robustness of causal inference in terms of correlations associated with unobserved variables.</p>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<p><code>konfound</code> is an <code>R</code> package to easily carry out sensitivity analysis as described in Frank, Maroulis, Duong, and Kelcey (2013) based on Rubin’s (1974) causal model.</p>
<div id="loading-konfound" class="section level3">
<h3 class="hasAnchor">
<a href="#loading-konfound" class="anchor"></a>Loading konfound</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(konfound)</code></pre></div>
<pre><code>## Loading konfound</code></pre>
<pre><code>## Sensitivity analysis as described in Frank, Maroulis, Duong, and Kelcey (2013).
## For more information visit https://jmichaelrosenberg.shinyapps.io/shinykonfound/.</code></pre>
</div>
<div id="use-of-pkonfound" class="section level3">
<h3 class="hasAnchor">
<a href="#use-of-pkonfound" class="anchor"></a>Use of pkonfound()</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pkonfound.html">pkonfound</a></span>(<span class="dv">2</span>, .<span class="dv">4</span>, <span class="dv">100</span>, <span class="dv">3</span>)</code></pre></div>
<pre><code>## Replacement of Cases Approach:
## To invalidate the inference, 60.3 % of the estimate would have to be due to bias.
## To invalidate the inference, 60 observations would have to be replaced with cases for which the effect is 0.
## 
## Correlation-based Approach:
## An omitted variable would have to be correlated at 0.568 with the outcome and at 0.568 with the predictor of interest (conditioning on observed covariates) to invalidate an inference.
## Correspondingly the impact of an omitted variable (as defined in Frank 2000) must be 0.568 X 0.568 = 0.754 to sustain an inference.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pkonfound.html">pkonfound</a></span>(<span class="dv">2</span>, .<span class="dv">4</span>, <span class="dv">100</span>, <span class="dv">3</span>, <span class="dt">to_return =</span> <span class="st">"thresh_plot"</span>)</code></pre></div>
<p><img src="Introduction_to_konfound_files/figure-html/unnamed-chunk-3-1.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pkonfound.html">pkonfound</a></span>(<span class="dv">2</span>, .<span class="dv">4</span>, <span class="dv">100</span>, <span class="dv">3</span>, <span class="dt">to_return =</span> <span class="st">"corr_plot"</span>)</code></pre></div>
<p><img src="Introduction_to_konfound_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pkonfound.html">pkonfound</a></span>(.<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">100</span>, <span class="dv">3</span>)</code></pre></div>
<pre><code>## Replacement of Cases Approach:
## To sustain the inference,  89.924 % of the estimate would have to be due to bias.To sustain the inference,  90  of the cases with 0 
##  effect would have to be replaced with cases at the threshold of inference.
## 
## Correlation-based Approach:
## An omitted variable would have to be correlated at 0.387 with the outcome and at 0.387 with the predictor of interest (conditioning on observed covariates) to sustain an inference.
## Correspondingly the impact of an omitted variable (as defined in Frank 2000) must be 0.387 X 0.387 = 0.622 to invalidate an inference.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pkonfound.html">pkonfound</a></span>(.<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">100</span>, <span class="dv">3</span>, <span class="dt">to_return =</span> <span class="st">"thresh_plot"</span>)</code></pre></div>
<p><img src="Introduction_to_konfound_files/figure-html/unnamed-chunk-5-1.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pkonfound.html">pkonfound</a></span>(<span class="fl">1.2</span>, <span class="dv">2</span>, <span class="dv">100</span>, <span class="dv">3</span>, <span class="dt">to_return =</span> <span class="st">"corr_plot"</span>)</code></pre></div>
<p><img src="Introduction_to_konfound_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div id="use-of-konfound" class="section level3">
<h3 class="hasAnchor">
<a href="#use-of-konfound" class="anchor"></a>Use of konfound()</h3>
<div id="for-linear-models-fit-with-lm" class="section level5">
<h5 class="hasAnchor">
<a href="#for-linear-models-fit-with-lm" class="anchor"></a>For linear models fit with lm()</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>hp <span class="op">+</span><span class="st"> </span>qsec, <span class="dt">data =</span> mtcars)
m1</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ wt + hp + qsec, data = mtcars)
## 
## Coefficients:
## (Intercept)           wt           hp         qsec  
##    27.61053     -4.35880     -0.01782      0.51083</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/konfound.html">konfound</a></span>(m1, hp)</code></pre></div>
<pre><code>## Replacement of Cases Approach:
## To sustain the inference,  41.327 % of the estimate would have to be due to bias.To sustain the inference,  13  of the cases with 0 
##  effect would have to be replaced with cases at the threshold of inference.
## 
## Correlation-based Approach:
## An omitted variable would have to be correlated at 0.322 with the outcome and at 0.322 with the predictor of interest (conditioning on observed covariates) to sustain an inference.
## Correspondingly the impact of an omitted variable (as defined in Frank 2000) must be 0.322 X 0.322 = 0.567 to invalidate an inference.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/konfound.html">konfound</a></span>(m1, <span class="dt">test_all =</span> T)</code></pre></div>
<pre><code>##   var_name unstd_beta std_err n_obs n_covariates     inference
## 1       wt     -4.359   0.753    32            2 to_invalidate
## 2       hp     -0.018   0.015    32            2    to_sustain
## 3     qsec      0.511   0.439    32            2    to_sustain
##   percent_bias replace_null_cases beta_threshhold omitted_variable_corr
## 1       64.669                 21     -1.54005792                 0.772
## 2       41.327                 13     -0.03067844                 0.322
## 3       43.087                 14      0.89785581                 0.329</code></pre>
<p>You can also return a table with some key output from the correlation-based approach.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/konfound.html">konfound</a></span>(m1, wt, <span class="dt">to_return =</span> <span class="st">"table"</span>)</code></pre></div>
<pre><code>## Dependent variable is mpg</code></pre>
<pre><code>##          term estimate std.error statistic p.value  itcv impact
## 1 (Intercept)   27.611     8.420     3.279   0.003    NA     NA
## 2          wt   -4.359     0.753    -5.791   0.000 0.243     NA
## 3          hp   -0.018     0.015    -1.190   0.244    NA  0.511
## 4        qsec    0.511     0.439     1.163   0.255    NA  0.073</code></pre>
</div>
<div id="for-generalized-linear-models-fit-with-glm" class="section level5">
<h5 class="hasAnchor">
<a href="#for-generalized-linear-models-fit-with-glm" class="anchor"></a>For generalized linear models fit with glm()</h5>
<p>Effects for these models are interpreted on the basis of average partial (or marginal) effects (calculated using the <code>margins</code> package).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># if forcats is not installed, this install it first using install.packages("forcats") for this to run</span>
<span class="cf">if</span> (<span class="kw">requireNamespace</span>(<span class="st">"forcats"</span>)) {
    d &lt;-<span class="st"> </span>forcats<span class="op">::</span>gss_cat
    
    d<span class="op">$</span>married &lt;-<span class="st"> </span><span class="kw">ifelse</span>(d<span class="op">$</span>marital <span class="op">==</span><span class="st"> "Married"</span>, <span class="dv">1</span>, <span class="dv">0</span>)

    m2 &lt;-<span class="st"> </span><span class="kw">glm</span>(married <span class="op">~</span><span class="st"> </span>age, <span class="dt">data =</span> d, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">"logit"</span>))
    <span class="kw"><a href="../reference/konfound.html">konfound</a></span>(m2, age)
}</code></pre></div>
<pre><code>## Warning in konfound(m2, age): For a non-linear mode, impact threshold
## should not be used.</code></pre>
<pre><code>## Replacement of Cases Approach:
## To sustain the inference,  80.978 % of the estimate would have to be due to bias.To sustain the inference,  17334  of the cases with 0 
##  effect would have to be replaced with cases at the threshold of inference.
## 
## Correlation-based Approach:
## An omitted variable would have to be correlated at 5.535 with the outcome and at 5.535 with the predictor of interest (conditioning on observed covariates) to invalidate an inference.
## Correspondingly the impact of an omitted variable (as defined in Frank 2000) must be 5.535 X 5.535 = 2.353 to sustain an inference.</code></pre>
</div>
</div>
<div id="use-of-mkonfound" class="section level3">
<h3 class="hasAnchor">
<a href="#use-of-mkonfound" class="anchor"></a>Use of mkonfound()</h3>
<p>Here, <code>df</code> represents output from a number of past studies.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">unstd_beta =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="fl">1.7</span>, .<span class="dv">4</span>, <span class="fl">3.2</span>, <span class="fl">1.0</span>, <span class="fl">2.3</span>, <span class="fl">4.1</span>, .<span class="dv">9</span>),
                 <span class="dt">std_error =</span> <span class="kw">c</span>(.<span class="dv">3</span>, <span class="fl">2.9</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, .<span class="dv">1</span>, .<span class="dv">04</span>, .<span class="dv">1</span>, <span class="dv">3</span>, .<span class="dv">5</span>),
                 <span class="dt">n_obs =</span> <span class="kw">c</span>(<span class="dv">70</span>, <span class="dv">405</span>, <span class="dv">200</span>, <span class="dv">100</span>, <span class="dv">103</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">721</span>, <span class="dv">320</span>),
                 <span class="dt">n_covs =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))
<span class="kw"><a href="../reference/mkonfound.html">mkonfound</a></span>(df)</code></pre></div>
<pre><code>##   unstd_beta std_error n_obs n_covs     inference percent_bias
## 1        2.0      0.30    70      3 to_invalidate       70.052
## 2       10.0      2.90   405      4 to_invalidate       42.989
## 3        1.7      1.50   200      1    to_sustain       42.529
## 4        0.4      2.00   100      3    to_sustain       89.924
## 5        3.2      0.10   103     10 to_invalidate       93.793
## 6        1.0      0.04    20      4 to_invalidate       91.474
## 7        2.3      0.10    50      1 to_invalidate       91.258
## 8        4.1      3.00   721      1    to_sustain       30.388
## 9        0.9      0.50   320      0    to_sustain        8.510
##   replace_null_cases beta_threshhold omitted_variable_corr
## 1                 49      0.59896933                 0.725
## 2                174      5.70114580                 0.283
## 3                 85      2.95802622                 0.227
## 4                 90      3.96996862                 0.387
## 5                 97      0.19860863                 0.974
## 6                 18      0.08525798                 0.990
## 7                 46      0.20106348                 0.971
## 8                219      5.88980656                 0.144
## 9                 27      0.98371419                 0.091</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/mkonfound.html">mkonfound</a></span>(df, <span class="dt">return_plot =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Introduction_to_konfound_files/figure-html/unnamed-chunk-10-1.png" width="480"></p>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<ul>
<li><p>Frank, K.A., Maroulis, S., Duong, M., and Kelcey, B. 2013. What would it take to Change an Inference?: Using Rubin’s Causal Model to Interpret the Robustness of Causal Inferences. Education, Evaluation and Policy Analysis. Vol 35: 437-460. <a href="https://msu.edu/~kenfrank/What%20would%20it%20take%20to%20Change%20an%20Inference%20published.docx">https://msu.edu/~kenfrank/What%20would%20it%20take%20to%20Change%20an%20Inference%20published.docx</a></p></li>
<li><p>Frank, K.A., Gary Sykes, Dorothea Anagnostopoulos, Marisa Cannata, Linda Chard, Ann Krause, Raven McCrory. 2008. Extended Influence: National Board Certified Teachers as Help Providers. Education, Evaluation, and Policy Analysis. Vol 30(1): 3-30. <a href="https://msu.edu/~kenfrank/papers/Does%20NBPTS%20Certification%20Affect%20the%20Number%20of%20Colleagues%20a%20Teacher%20Helps%20with%20Instructional%20Matters%20acceptance%20version%202.doc">https://msu.edu/~kenfrank/papers/Does%20NBPTS%20Certification%20Affect%20the%20Number%20of%20Colleagues%20a%20Teacher%20Helps%20with%20Instructional%20Matters%20acceptance%20version%202.doc</a></p></li>
<li><p>Frank, K. A. and Min, K. 2007. Indices of Robustness for Sample Representation. Sociological Methodology. Vol 37, 349-392. <a href="https://msu.edu/~kenfrank/papers/INDICES%20OF%20ROBUSTNESS%20TO%20CONCERNS%20REGARDING%20THE%20REPRESENTATIVENESS%20OF%20A%20SAMPLE.doc">https://msu.edu/~kenfrank/papers/INDICES%20OF%20ROBUSTNESS%20TO%20CONCERNS%20REGARDING%20THE%20REPRESENTATIVENESS%20OF%20A%20SAMPLE.doc</a> (co first authors)</p></li>
<li><p>Frank, K. 2000. “Impact of a Confounding Variable on the Inference of a Regression Coefficient.” Sociological Methods and Research, 29(2), 147-194 <a href="https://msu.edu/~kenfrank/papers/impact%20of%20a%20confounding%20variable.pdf">https://msu.edu/~kenfrank/papers/impact%20of%20a%20confounding%20variable.pdf</a></p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#abstract">Abstract</a></li>
      <li><a href="#introduction">Introduction</a></li>
      <li><a href="#examples">Examples</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Joshua M Rosenberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
